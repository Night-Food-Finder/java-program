<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.nff.repository.dao.LoginDAO">

	<!-- 일반회원 가입(naver) -->
	<insert id="insertNaverUser" parameterType="User" >
		insert into tb_user (user_id, user_name, user_email, user_gender, user_age) values
			(#{userId},#{userName},#{userEmail},#{userGender},#{userAge})
	</insert>
	
	<!-- naver 회원 체크 -->
	<select id="selectNaver" resultType="int" parameterType="User">
		select count(*) from tb_user 
			where user_email = #{userEmail}
	</select>
	
	<!-- 가게 이메일 중복체크 -->
	<select id="storeEmailChk" parameterType="String" resultType="int" flushCache="true" useCache="true">
		select count(*) from tb_store where store_email = #{storeEmail}
	</select>
	
	<!-- 가게 회원가입(휴일 제외 정보 insert) -->
	<insert id="storeUpdateInfo" parameterType="Store">
		insert into tb_store 
			(store_name, business_num, store_email, store_pass, store_tell,
				) values (#{storeName}, #{business_num}, #{store_email}, #{store_pass}, #{store_tell})
	</insert>
	<!-- 가게 회원가입(휴일 정보 insert) -->
	<insert id="updateHoliday" parameterType="Store">
		<if test="day != null">
			INSERT INTO tb_holiday (week_no, store_no) VALUES
			<foreach collection="day" item="weekNo" separator=",">
				(#{weekNo}, #{storeNo})
			</foreach>
		</if>
	</insert>
	
	<select id="selectLoginOneUser" parameterType="String" resultType="User">
	 select * 
	  from tb_user
	  where user_id = #{userId}
	</select>
	
</mapper>  