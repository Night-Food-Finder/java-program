<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <title>Google Maps Multiple Markers</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript"></script>
  <style>
    .container {
      display: grid;
      grid-template-columns: 1fr 1fr;
    }
  </style>
</head>

<body>
  <div class="container">
    <div id="storeList">
      <ul>
        <li id="li_1" class="storeLn" data-store="수저가">수저가</li>
        <li id="li_2" class="storeLn" data-store="맛있는집">맛있는집</li>
        <li id="li_3" class="storeLn" data-store="청석골">청석골</li>
        <li id="li_4" class="storeLn" data-store="가츠벤또">가츠벤또</li>
      </ul>
    </div>


    <div id="map" style="width: 500px; height: 400px;"></div>
  </div>

  <script type="text/javascript">
    var map;
    let markerArr = [];
    let infowindow;
    let locations;
    let markerImage;

    let eventMarker;

    $(".storeLn").click((e) => {
      // console.log("클릭하기이름", $(e.target).data("store"));
      markerEvent($(e.target).data("store"));
    });

    function markerEvent(storeName) {
      // map.setZoom(20);
      infowindow.setContent(locations[0][0]);
      infowindow.open(map, markerArr[0]);
      markerImage = new google.maps.MarkerImage("https://www.siksinhot.com/static2/images/common/bg_ico_s_like.png",
        null, null, null, new google.maps.Size(30, 50));
      markerImage = new google.maps.MarkerImage("",
        null, null, null, new google.maps.Size(30, 50));
      console.dir(markerArr[0]);
      console.log(markerArr[0].store_name);
      map.setCenter(new google.maps.LatLng(locations[0][1], locations[0][2]));

      for (let i = 0; i < markerArr.length; i++) {
        markerArr[i].setAnimation(null)
        if (markerArr[i].store_name == storeName) {
          if (markerArr[i].getAnimation() !== null) {
            eventMarker = markerArr[i];
            markerArr[i].setAnimation(null)
            markerArr[i].setIcon(markerImage);
          } else {
            markerArr[i].setAnimation(google.maps.Animation.BOUNCE);
            markerArr[i].setIcon(markerImage);
          }
        }
      }



      //  markerArr[0].setMap(null);
      // markerArr[0].remove();
    }

    function drawMap() {
      // 나온 마커로 중심좌표 찾기
      locations = [
        ['수저가', 37.5493313, 126.937287],
        ['맛있는집', 37.5529261, 126.937012],
        ['청석골', 37.5677797, 126.905045],
        ['가츠벤또', 37.5537907, 126.921552]
      ];
      let y = 0;
      let x = 0;
      let u = 0;
      for (u = 0; u < locations.length; u++) {
        y += locations[u][1];
        x += locations[u][2];
        u = u;
        console.log(typeof (locations[u][1]));
        console.log(y);
      }
      console.log("yxu입니다 : ", y, x, u);
      y = y / u;
      x = x / u;

      console.log("나눈 값", y, x);


      map = new google.maps.Map(document.getElementById('map'), {
        zoom: 12,
        center: new google.maps.LatLng(y, x),
        mapTypeId: google.maps.MapTypeId.ROADMAP
      });

      infowindow = new google.maps.InfoWindow();

      //마커 뿌려주기
      var i;

      for (i = 0; i < locations.length; i++) {
        var marker = new google.maps.Marker({
          id: i,
          position: new google.maps.LatLng(locations[i][1], locations[i][2]),
          animation: google.maps.Animation.DROP,
          store_name: locations[i][0],
          store_lati: locations[i][1],
          store_long: locations[i][2],
          icon: null,
          map: map
        });
        markerArr.push(marker);




        google.maps.event.addListener(marker, 'click', (function (marker, i) {
          return function () {
            infowindow.setContent(locations[i][0]);
            infowindow.open(map, marker);
          }
        })(marker, i));
        /*
        if(marker.store_name === "청석골") {
             var markerImage = new
               google.maps.MarkerImage("https://www.siksinhot.com/static2/images/common/bg_ico_s_like.png",
               null, null, null, new
               google.maps.Size(12,20));
               marker.icon = markerImage;
        }
        */

        if (marker) {
          // console.log("이름내놔", marker.store_name);
          marker.addListener('click', function () {
            map.setZoom(15);
            map.setCenter(this.getPosition());
            // alert(this.store_name); 누른 현재의 가게 이름
          });
        }


      }

    };
    drawMap();
  </script>
</body>

</html>